Cenario: Atualizar Reserva com Sucesso
    ${dates}=    Create Dictionary    checkin=2025-01-01    checkout=2025-01-07
    &{payload}=     Create Dictionary    firstname=James    lastname=Bond    totalprice=700    depositpaid=${False}    additionalneeds=Martini
    Set To Dictionary    ${payload}    bookingdates=${dates}
    Editar Reserva    ${BOOKING_ID}    &{payload}

Cenario: Tentar Atualizar Reserva Sem Autenticacao
    ${dates}=    Create Dictionary    checkin=2025-01-01    checkout=2025-01-07
    &{payload}=     Create Dictionary    firstname=James    lastname=Bond    totalprice=700    depositpaid=${False}    additionalneeds=Martini
    Set To Dictionary    ${payload}    bookingdates=${dates}
    Tentar Editar Reserva Sem Token    ${BOOKING_ID}    &{payload}

Cenario: Atualizar Parcialmente Reserva com Sucesso
    ${payload_parcial}=    Create Dictionary    firstname=John    lastname=Wick
    Editar Parcialmente Reserva    ${BOOKING_ID}    ${payload_parcial}

Cenario: Tentar Atualizar Parcialmente Sem Autenticacao
    ${payload_parcial}=    Create Dictionary    firstname=John
    Tentar Editar Parcialmente Sem Token    ${BOOKING_ID}    ${payload_parcial}

Cenario: Deletar Reserva com Sucesso
    ${resposta}=    Deletar Reserva    ${BOOKING_ID}    201

Cenario: Verificar se Reserva foi Deletada
    Deletar Reserva    ${BOOKING_ID}    201
    Consultar Reserva por ID    ${BOOKING_ID}    404

Cenario: Tentar Deletar Reserva Sem Autenticacao
    Tentar Deletar Reserva Sem Token    ${BOOKING_ID}

Cenario: Tentar Deletar Reserva Inexistente
    [Setup]    No Operation
    ${id_invalido}=    Set Variable    99999999
    Deletar Reserva    ${id_invalido}    405



Criar Nova Reserva Para Teste
    ${booking_body}=    Create Dictionary
    ...                 firstname=Jim
    ...                 lastname=Brown
    ...                 totalprice=111
    ...                 depositpaid=${True}
    ...                 additionalneeds=Breakfast
    ${dates}=           Create Dictionary
    ...                 checkin=2024-01-01
    ...                 checkout=2024-01-02
    Set To Dictionary    ${booking_body}    bookingdates    ${dates}
    ${post_response}=    POST On Session
    ...                  Restful-booker
    ...                  /booking
    ...                  json=${booking_body}
    Status Should Be    200    ${post_response}
    ${new_booking}=      Set Variable         ${post_response.json()}
    ${new_booking_id}=   Get From Dictionary    ${new_booking}    bookingid
    Set Test Variable    ${BOOKING_ID}    ${new_booking_id}

Editar Reserva
    [Arguments]    ${booking_id}    ${payload}
    ${header_dict}=     Create Dictionary
    ...                 Content-Type=application/json
    ...                 Accept=application/json
    ...                 Cookie=token=${TOKEN}
    ${put_response}=    PUT On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 json=${payload}
    ...                 headers=${header_dict}
    Status Should Be    200    ${put_response}

Tentar Editar Reserva Sem Token
    [Arguments]    ${booking_id}    ${payload}
    ${header_dict}=     Create Dictionary
    ...                 Content-Type=application/json
    ...                 Accept=application/json
    PUT On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 json=${payload}
    ...                 headers=${header_dict}
    ...                 expected_status=403

Editar Parcialmente Reserva
    [Arguments]    ${booking_id}    ${payload}
    ${headers}=         Create Dictionary
    ...                 Content-Type=application/json
    ...                 Accept=application/json
    ...                 Cookie=token=${TOKEN}
    ${patch_response}=  PATCH On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 json=${payload}
    ...                 headers=${headers}
    Status Should Be    200    ${patch_response}

Tentar Editar Parcialmente Sem Token
    [Arguments]    ${booking_id}    ${payload}
    ${header_dict}=     Create Dictionary
    ...                 Content-Type=application/json
    ...                 Accept=application/json
    PATCH On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 json=${payload}
    ...                 headers=${header_dict}
    ...                 expected_status=403

Deletar Reserva
    [Arguments]    ${booking_id}    ${expected_status}
    ${headers}=         Create Dictionary    Cookie=token=${TOKEN}
    ${delete_response}=    DELETE On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 headers=${headers}
    ...                 expected_status=${expected_status}
    RETURN    ${delete_response}

Tentar Deletar Reserva Sem Token
    [Arguments]    ${booking_id}
    DELETE On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 expected_status=403

Consultar Reserva por ID
    [Arguments]    ${booking_id}    ${expected_status}
    GET On Session
    ...                 Restful-booker
    ...                 /booking/${booking_id}
    ...                 expected_status=${expected_status}
